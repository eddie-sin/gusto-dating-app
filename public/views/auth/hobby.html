<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hobby — Select</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Rufina:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
  
<!-- Font Awesome (working CDN) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

  <style>
    body {
      font-family: "Poppins", sans-serif;
      background-image: url('../../img/bgimg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    /* Shared Next/Skip button from coworker design */
    .next-btn {
      width: 120px;
      padding: 10px 10px;
      font-family: 'Rufina', serif;
      font-size: 17px;
      color: black;
      background: linear-gradient(135deg, #F78998 0%, #fa97a9 50%, #F78998 100%);
      position: relative;
      overflow: hidden;
      border-width: 0.11rem;
      border-style: solid;
      border-top-color: #ffffffcc;
      border-bottom-color: #ffffffcc;
      border-left-color: #fa97a9;
      border-right-color: #fa97a9;
      border-radius: 55px;
      box-shadow: 0px 36.86px 13.98px rgba(255, 106, 106, 0.02),
                  0px 20.34px 12.71px rgba(255, 106, 106, 0.08),
                  0px 8.9px 8.9px rgba(255, 106, 106, 0.13),
                  0px 2.54px 5.08px rgba(255, 106, 106, 0.15);
      cursor: pointer;
      transition: 0.25s ease;
    }
    .next-btn::before { content:""; position:absolute; top:0; left:0; height:100%; width:100%; background: linear-gradient(90deg, rgba(255,255,255,0.35) 0%, rgba(255,255,255,0) 40%, rgba(255,255,255,0) 60%, rgba(255,255,255,0.35) 100%); pointer-events:none; border-radius:55px; }
    .next-btn:hover { transform: translateY(-2px) scale(1.02); }

    /* Spinner for Next/Skip buttons */
    .loading { display:inline-block; width:16px; height:16px; border:3px solid rgba(255,255,255,0.3); border-radius:50%; border-top-color:white; animation:spin 1s linear infinite; margin-left:8px; }
    .hidden { display:none !important; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Floating glass card (same as Confirm Document) */
    .glass {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 4px 30px rgba(255, 182, 193, 0.3);
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .animate-float { animation: float 4s ease-in-out infinite; }

    /* Heart shape background */
    .heart-bg {
      position: absolute;
      top: 52%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 650px;
      height: 650px;
      background: radial-gradient(circle at 50% 25%,
          rgba(255, 85, 130, 0.65),
          rgba(255, 70, 110, 0.55),
          rgba(255, 60, 105, 0.30),
          transparent 70%);
      filter: blur(45px);
      opacity: 1;
      pointer-events: none;
      clip-path: path(
        "M 250 0 
         C 390 0, 520 110, 520 230 
         C 520 360, 350 480, 250 560 
         C 150 480, -20 360, -20 230 
         C -20 110, 110 0, 250 0 Z"
      );
    }

    /* Pill selected */
    .pill-selected {
      background: linear-gradient(145deg, #f4b7c3, #ee90a3) !important;
      color: black !important;
      box-shadow: 0 0 15px rgba(255, 120, 150, 0.9) !important;
      transform: scale(1.1);
    }

    /* MBTI Button */
    .mbti-btn {
      position: relative;
      background: radial-gradient(
          circle at 30% 100%,
          rgba(255, 255, 255, 0.55) 0%,
          rgba(255, 255, 255, 0.25) 35%,
          rgba(255, 182, 193, 0.18) 60%,
          rgba(255, 160, 180, 0.1) 80%,
          rgba(255, 150, 170, 0.05) 100%
        ),
        rgba(255, 192, 203, 0.25);
      border-radius: 1.2rem;
      color: #111;
      font-weight: 500;
      transition: all 0.25s ease-in-out;
      overflow: hidden;
      z-index: 1;
      box-shadow: inset 0 0 1px rgba(255, 255, 255, 0.6),
                  inset 0 -1px 3px rgba(255, 255, 255, 0.4);
    }

    .mbti-btn::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      padding: 1.4px;
      background: linear-gradient(
        150deg,
        rgba(255, 255, 255, 0.9),
        rgba(255, 190, 210, 0.65)
      );
      -webkit-mask: linear-gradient(#fff 0 0) content-box,
                     linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      z-index: -1;
    }

    .mbti-btn:hover {
      transform: scale(1.06);
      box-shadow: 0 0 18px rgba(255, 180, 200, 0.85);
    }

    /* ===== MOBILE HOBBY SLIDER (hearts) ===== */
    .mobile-hobby-wrapper {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      width: 100%;
      margin-top: -8px;
      overflow: hidden; /* keep only one heart visible */
    }

    .mobile-hobby-track {
      display: flex;
      width: 100%;
      transition: transform 0.3s ease;
    }

    .mobile-hobby-slide {
      flex: 0 0 100%;
      display: flex;
      justify-content: center;
    }

    .mobile-heart {
      position: relative;
      width: 70%;
      max-width: 260px;
      padding: 20px 14px 18px;
      border-radius: 999px;
      background: radial-gradient(circle at 50% 25%, rgba(255, 120, 150, 0.9), rgba(255, 90, 130, 0.72), rgba(255, 90, 130, 0.45));
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    }

    .mobile-heart-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }

    .mobile-heart-row {
      display: flex;
      justify-content: center;
      gap: 8px;
    }

    .mobile-hobby-dots {
      display: flex;
      justify-content: center;
      gap: 6px;
      margin-top: 2px;
    }

    .mobile-hobby-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.55);
      background: transparent;
      padding: 0;
    }

    .mobile-hobby-dot-active {
      background: black;
    }

    @media (max-width: 640px) {
      /* Hide desktop-style hobby cloud on small screens */
      #hobbyContainer {
        display: none;
      }

      .mobile-hobby-wrapper {
        display: flex;
      }
    }


     .modal-content {
  width: min(720px, calc(100% - 32px));
  max-height: 35vh; /* <-- limit height to 80% of viewport */
  margin-top: 28px;
  border-radius: 12px;
  overflow: hidden;
  backdrop-filter: blur(10px);
  background: rgba(255,255,255,0.85);
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
}

/* Body scroll */
.modal-body {
  padding: 16px;
  overflow-y: auto;  /* <-- scroll vertically if content is too tall */
  flex: 1 1 auto;    /* take remaining space in modal */
}

#uploadGuidanceModal {
  display: none; /* hidden by default */
  position: fixed;
  inset: 0;
  justify-content: center;
  align-items: flex-start; /* top pop-up */
  z-index: 9999;
  padding-top: 14%;
}

/* NEW: visible state */
#uploadGuidanceModal.open {
  display: flex;
  pointer-events: auto;
  animation: slideDown 260ms ease-out;
}

@keyframes slideDown {
  from { transform: translateY(-10px); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}

/* UPDATED modal content to be a top bar with responsive width */
.modal-content {
  width: min(720px, calc(100% - 32px));
  margin-top: 28px;    /* distance from viewport top */
  border-radius: 12px;
  overflow: hidden;
  backdrop-filter: blur(10px);
   background: rgba(255,255,255,0.85);
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

/* NEW: header bar (red/pink) */
.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: linear-gradient(90deg,#F78998,#fa97a9 60%);
  color: white;
}

/* NEW: header title */
.modal-header h2 {
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
}

/* NEW: close button using Font Awesome */
.modal-close-button {
  background: transparent;
  border: none;
  color: white;
  font-size: 18px;
  cursor: pointer;
  padding: 6px;
  border-radius: 6px;
}
.modal-close-button:focus { outline: 2px solid rgba(255,255,255,0.3); }

/* small-screen tweak */
@media (max-width:420px) {
  .modal-content { width: calc(100% - 16px); margin-top: 16px; }
  .modal-header h2 { font-size: 0.95rem; }
}


.info-icon {
  font-size: 20px;
  color: black;
  cursor: pointer;
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 10;
}

.custom-leading {
  line-height: 1.6; /* adjust this value as needed */
}

  </style>
</head>


<body class="flex flex-col items-center justify-center min-h-screen px-4 relative overflow-auto">

  <!-- Back button -->
  <div class="w-full mb-6">
    <a href="photos.html" class="mbti-btn inline-flex items-center justify-center gap-2 w-[95px] sm:w-[105px] md:w-[115px] h-[40px] sm:h-[43px] md:h-[45px] px-4 sm:px-6 text-base sm:text-lg">
      <i class="fa-solid fa-arrow-left text-lg sm:text-xl"></i>
      <span class="font-serif leading-none">Back</span>
    </a>
  </div>


  <!-- Floating Glass Card (EXACT SAME AS CONFIRM PAGE) -->
  <div class="glass relative z-10 w-[92%] sm:w-[85%] md:w-[75%] lg:w-[68%] xl:w-[58%] 
              max-w-[760px] rounded-3xl p-8 sm:p-10 md:p-12 text-center animate-float">

    
<span class="info-icon" onclick="openGuidanceModal()" role="button" aria-label="Upload guidance" title="Upload guidance">
  <i class="fa-solid fa-circle-exclamation" style="font-size:20px; color:black;"></i>
</span>

<!-- modal inner structure with a top-bar header + body -->
<div id="uploadGuidanceModal" aria-hidden="true" role="dialog" aria-labelledby="uploadGuidanceTitle">
  <div class="modal-content" role="document">
    <div class="modal-header">
      <h2 id="uploadGuidanceTitle" class="text-base sm:text-lg md:text-xl lg:text-2xl custom-leading">User guidance</h2>
      <!-- Font Awesome X icon (accessible button) -->
      <button class="modal-close-button" onclick="closeGuidanceModal()" aria-label="Close upload guidance">
        <i class="fa-solid fa-xmark" aria-hidden="true"></i>
      </button>
    </div>

    <div class="modal-body" style="padding:16px; text-align:left;">
      <div class="modal-body p-4 text-left font-inter font-normal">
        <p class="mb-4 text-sm sm:text-base md:text-lg lg:text-xl font-medium custom-leading">How to fill the data correctly:</p>
  
        <ul class="list-disc list-inside text-xs sm:text-sm md:text-base lg:text-lg mb-4 custom-leading">
<li>Please select the hobby or the activities you most often do in your spare (holiday) time.</li>
        </ul>
      </div>
    </div>
  </div>
</div>




    <h2 class="text-gray-1200 text-xl sm:text-2xl md:text-3xl mb-16">
      What's your Hobby?
    </h2>

    <!-- Pill Layout (desktop / tablet) -->
    <div id="hobbyContainer" class="relative z-10 flex flex-col items-center space-y-3 md:space-y-4">
      <div class="flex gap-16 justify-center translate-y-0 translate-x-0"></div>
      <div class="flex gap-4 justify-center -translate-y-2 translate-x-1"></div>
      <div class="flex gap-2 justify-center -translate-y-3 translate-x-1"></div>
      <div class="flex gap-4 justify-center -translate-y-4 translate-x-0"></div>
      <div class="flex gap-8 justify-center -translate-y-6 -translate-x-4"></div>
      <div class="flex gap-32 justify-center -translate-y-7 -translate-x-1"></div>
      <div class="flex gap-3 justify-center -translate-y-7 -translate-x-1"></div>
      <div class="flex gap-4 justify-center -translate-y-7 -translate-x-1"></div>
    </div>

    <!-- Mobile-only slider with 2 small heart cards -->
    <div id="mobileHobbyWrapper" class="mobile-hobby-wrapper">
      <div id="mobileHobbyTrack" class="mobile-hobby-track">
        <div class="mobile-hobby-slide" data-slide-index="0">
          <div class="mobile-heart">
            <div id="mobileHeartInner1" class="mobile-heart-inner"></div>
          </div>
        </div>
        <div class="mobile-hobby-slide" data-slide-index="1">
          <div class="mobile-heart">
            <div id="mobileHeartInner2" class="mobile-heart-inner"></div>
          </div>
        </div>
      </div>
      <div class="mobile-hobby-dots">
        <button type="button" class="mobile-hobby-dot mobile-hobby-dot-active" data-target-slide="0"></button>
        <button type="button" class="mobile-hobby-dot" data-target-slide="1"></button>
      </div>
    </div>

    <!-- Buttons -->
    <div class="flex justify-center gap-6 mt-10">
      <button id="skipBtn" class="next-btn"><span class="btn-text">Skip</span><span class="loading hidden"></span></button>
      <button id="nextBtn" class="next-btn"><span class="btn-text">Next</span><span class="loading hidden"></span></button>
    </div>

  </div>

  <!-- JS for pills -->
  <script>
    const rows = [
      ["Singing", "Music"],
      ["Cooking", "Reading", "Travel"],
      ["Learn", "Fashion", "Photography", "Exercise"],
      ["Dancing", "Painting", "Gaming", "Crafting"],
      ["Graphic Design", "Movie", "Football"],
      ["Gym", "Camping"],
      ["Video Editing", "Volunteering"],
      ["Coding"]
    ];

    const container = document.getElementById("hobbyContainer");
    const mobileHeartInner1 = document.getElementById("mobileHeartInner1");
    const mobileHeartInner2 = document.getElementById("mobileHeartInner2");

    function createPillElement(text, widthClass) {
      const pill = document.createElement("div");
      pill.className =
        "text-center py-2 bg-[#E78597] border border-[#e8acb8]/60 " +
        "rounded-full text-[14px] md:text-[15px] text-gray-800 shadow-md " +
        "backdrop-blur-sm cursor-pointer transition hover:scale-105";
      if (widthClass) pill.classList.add(widthClass);
      pill.textContent = text;
      pill.dataset.hobby = text.toLowerCase();
      return pill;
    }

    // Desktop / tablet layout
    rows.forEach((rowItems, i) => {
      const row = container.children[i];

      rowItems.forEach(text => {
        let widthClass = "";
        if (i === 0) widthClass = "w-[150px]";
        if (i === 1) widthClass = "w-[140px]";
        if (i === 2) widthClass = "w-[130px]";
        if (i === 3) widthClass = "w-[135px]";
        if (i === 4) widthClass = "w-[145px]";
        if (i === 5) widthClass = "w-[150px]";
        if (i === 6) widthClass = "w-[160px]";
        if (i === 7) widthClass = "w-[170px]";

        const pill = createPillElement(text, widthClass);
        row.appendChild(pill);
      });
    });

    // Flatten hobbies and distribute between two mobile hearts using
    // explicit heart-like row patterns.
    const allHobbies = rows.flat();

    function fillMobileHeart(innerEl, startIndex, pattern) {
      let index = startIndex;
      pattern.forEach(count => {
        const row = document.createElement("div");
        row.className = "mobile-heart-row";
        for (let i = 0; i < count && index < allHobbies.length; i++, index++) {
          const text = allHobbies[index];
          const pill = createPillElement(text, "px-3");
          row.appendChild(pill);
        }
        innerEl.appendChild(row);
      });
      return index;
    }

    // First heart: 2-3-3-2-1 rows (top to bottom)
    let nextStart = fillMobileHeart(mobileHeartInner1, 0, [2, 3, 3, 2, 1]);
    // Second heart: custom pattern 2-3-2-2-1 rows (10 items) to keep a pointed bottom
    fillMobileHeart(mobileHeartInner2, nextStart, [2, 3, 2, 2, 1]);

    // Keep selections in sync across all pill copies
    document.addEventListener("click", (e) => {
      const target = e.target;
      if (!target || !target.dataset || !target.dataset.hobby) return;
      const hobbyKey = target.dataset.hobby;
      const allMatching = document.querySelectorAll(`[data-hobby="${hobbyKey}"]`);
      const shouldSelect = !target.classList.contains("pill-selected");
      allMatching.forEach(el => {
        el.classList.toggle("pill-selected", shouldSelect);
      });
    });

    // Mobile slider behavior
    const mobileTrack = document.getElementById("mobileHobbyTrack");
    const mobileDots = Array.from(document.querySelectorAll(".mobile-hobby-dot"));
    let mobileCurrentSlide = 0;

    function setMobileSlide(index) {
      mobileCurrentSlide = index;
      mobileTrack.style.transform = `translateX(-${index * 100}%)`;
      mobileDots.forEach((dot, i) => {
        dot.classList.toggle("mobile-hobby-dot-active", i === index);
      });
    }

    mobileDots.forEach(dot => {
      dot.addEventListener("click", () => {
        const targetIndex = Number(dot.dataset.targetSlide || "0");
        setMobileSlide(targetIndex);
      });
    });

    // Basic touch swipe support on mobile track
    let touchStartX = null;
    mobileTrack.addEventListener("touchstart", (e) => {
      if (!e.touches || !e.touches.length) return;
      touchStartX = e.touches[0].clientX;
    });

    mobileTrack.addEventListener("touchend", (e) => {
      if (touchStartX === null) return;
      const endX = e.changedTouches[0].clientX;
      const deltaX = endX - touchStartX;
      const threshold = 40; // minimal swipe distance
      if (Math.abs(deltaX) > threshold) {
        if (deltaX < 0 && mobileCurrentSlide < 1) {
          setMobileSlide(1);
        } else if (deltaX > 0 && mobileCurrentSlide > 0) {
          setMobileSlide(0);
        }
      }
      touchStartX = null;
    });

    document.getElementById('skipBtn').addEventListener('click', (e) => {
      e.preventDefault();
      const orig = window.collectPageData;
      window.collectPageData = () => ({ hobbies: [] });
      document.dispatchEvent(new Event('registration:submit'));
      window.collectPageData = orig;
    });

    document.getElementById('nextBtn').addEventListener('click', (e) => {
      e.preventDefault();
      document.dispatchEvent(new Event('registration:submit'));
    });

    // Registration hooks
    window.prefillPage = function(prefill) {
      const list = prefill.hobbies ?? JSON.parse(localStorage.getItem('hobbies') || '[]');
      if (!Array.isArray(list) || list.length === 0) return;
      document.querySelectorAll('[data-hobby]').forEach(el => {
        const key = el.dataset.hobby;
        if (list.includes(key)) el.classList.add('pill-selected');
        else el.classList.remove('pill-selected');
      });
    };

    window.collectPageData = function() {
      const selected = document.querySelectorAll('.pill-selected');
      const hobbies = Array.from(new Set(Array.from(selected).map(pill => pill.dataset.hobby)));
      if (hobbies.length > 5) {
        alert('⚠️ You can select a maximum of 5 hobbies.');
        return null;
      }
      localStorage.setItem('hobbies', JSON.stringify(hobbies));
      return { hobbies };
    };

      function openGuidanceModal() {
  document.getElementById('uploadGuidanceModal').style.display = 'flex';
}
function closeGuidanceModal() {
  document.getElementById('uploadGuidanceModal').style.display = 'none';
}
  </script>
  <script type="module" src="/js/registration.js"></script>

</body>
</html>
