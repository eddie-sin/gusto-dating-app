<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Password</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: url('/img/bgimg.jpg') center/cover no-repeat fixed;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      margin: 0;
    }

    .card {
      width: 420px;
      max-width: calc(100% - 64px);
      height: 380px;
      border-radius: 28px;
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      text-align: center;
      padding: 48px 56px;
      position: relative;
      overflow: hidden;
    }

    .heart-bg {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      height: 320px;
      background: radial-gradient(circle at center, rgba(255, 77, 109, 0.3), transparent 70%);
      clip-path: path("M24 80 C24 24, 128 -24, 256 80 C384 -24, 488 24, 488 80 C488 216, 256 424, 256 424 C256 424, 24 216, 24 80 Z");
      z-index: 0;
    }

    h2 {
      font-size: 26px;
      color: #000;
      margin-bottom: 38px;
      font-weight: 500;
      position: relative;
      z-index: 2;
    }

    label {
      display: block;
      text-align: left;
      font-size: 14px;
      color: #111;
      margin-bottom: 6px;
      margin-top: 14px;
      position: relative;
      z-index: 2;
    }

    .input-wrapper {
      position: relative;
      z-index: 2;
    }

    input[type="password"],
    input[type="text"] {
    width: 100%;
    padding: 10px 44px 10px 14px;
    border-radius: 12px;
    border: 1px solid rgba(255, 100, 130, 0.5);
    background: rgba(255, 255, 255, 0.25);
    color: #111;
    font-size: 15px;
    outline: none;
    transition: 0.25s ease;
    backdrop-filter: blur(10px);
    }

    input[type="password"]:focus,
    input[type="text"]:focus {
    border-color: rgba(255, 120, 150, 0.9);
    box-shadow: 0 0 8px rgba(255, 120, 150, 0.4);
    }

    .toggle-eye {
      position: absolute;
      top: 50%;
      right: 14px;
      transform: translateY(-50%);
      cursor: pointer;
      opacity: 0.6;
      transition: 0.25s ease;
    }

    .toggle-eye:hover {
      opacity: 1;
      transform: translateY(-50%) scale(1.1);
    }

    .btn-soft {
      margin-top: 32px;
      width: 100%;
      background: linear-gradient(145deg, rgba(255,255,255,0.7), rgba(255,255,255,0.25));
      border: 1px solid rgba(255,255,255,0.4);
      color: #222;
      border-radius: 22px;
      padding: 10px 36px;
      font-weight: 500;
      font-size: 16px;
      box-shadow:
        inset 0 1px 2px rgba(255,255,255,0.9),
        0 4px 10px rgba(255,150,170,0.4);
      backdrop-filter: blur(8px);
      transition: all 0.3s ease;
    }

    .btn-soft:hover {
      transform: scale(1.05);
      background: linear-gradient(145deg, rgba(255,220,230,0.9), rgba(255,190,210,0.4));
      box-shadow:
        inset 0 1px 3px rgba(255,255,255,0.9),
        0 0 12px rgba(255,140,170,0.8);
    }

    .back-btn {
      position: absolute;
      top: 28px;
      left: 28px;
      background: linear-gradient(145deg, rgba(255,255,255,0.7), rgba(255,255,255,0.25));
      border: 1px solid rgba(255,255,255,0.4);
      border-radius: 22px;
      color: #111;
      font-size: 16px;
      padding: 8px 22px;
      font-weight: 500;
      box-shadow:
        inset 0 1px 2px rgba(255,255,255,0.9),
        0 4px 10px rgba(255,150,170,0.4);
      backdrop-filter: blur(8px);
      transition: all 0.3s ease;
      z-index: 3;
    }

    .back-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 12px rgba(255,140,170,0.8);
    }

  </style>
</head>

<body>
  <button onclick="window.location.href='StudentId1Holder.html'" class="back-btn">← Back</button>

  <div class="card">
    <div class="heart-bg"></div>

    <h2>Password</h2>

    <form onsubmit="return false;">
      <label for="username">Username</label>
      <div class="input-wrapper">
        <input type="text" id="username" placeholder="Enter username (3-30 characters)" />
      </div>

      <label for="password">Enter Password</label>
      <div class="input-wrapper">
        <input type="password" id="password" />
        <img src="img/eye.svg" class="toggle-eye" onclick="togglePassword('password', this)" alt="eye icon">
      </div>

      <label for="confirm">Confirm Password</label>
      <div class="input-wrapper">
        <input type="password" id="confirm" />
        <img src="img/eye.svg" class="toggle-eye" onclick="togglePassword('confirm', this)" alt="eye icon">
      </div>

      <button id="continueBtn" class="btn-soft mt-6">Continue</button>
    </form>
  </div>

  <script>
    function togglePassword(id, icon) {
    const input = document.getElementById(id);
    if (input.type === "password") {
        input.type = "text";
        icon.src = "img/eye-off.svg";
    } else {
        input.type = "password";
        icon.src = "img/eye.svg";
    }
    }

    // Get nickname from first name for default username suggestion
    function getNickname() {
      const firstName = localStorage.getItem('firstName') || '';
      return firstName.toLowerCase().replace(/[^a-z0-9._]/g, '');
    }

    // Set default username on load
    document.addEventListener('DOMContentLoaded', () => {
      const usernameInput = document.getElementById('username');
      usernameInput.value = getNickname();
    });

    document.getElementById('continueBtn').addEventListener('click', () => {
      const username = document.getElementById('username').value.trim().toLowerCase();
      const password = document.getElementById('password').value;
      const confirm = document.getElementById('confirm').value;

      // Validation
      if (!username) {
        alert('⚠️ Username is required.');
        return;
      }
      if (username.length < 3 || username.length > 30) {
        alert('⚠️ Username must be between 3 and 30 characters.');
        return;
      }
      if (!/^[a-z0-9._]+$/.test(username)) {
        alert('⚠️ Username may contain lowercase letters, numbers, dot and underscore only.');
        return;
      }

      if (!password) {
        alert('⚠️ Password is required.');
        return;
      }
      if (password.length < 8) {
        alert('⚠️ Password must be at least 8 characters long.');
        return;
      }

      if (password !== confirm) {
        alert('⚠️ Passwords do not match.');
        return;
      }

      localStorage.setItem('username', username);
      localStorage.setItem('password', password);
      window.location.href = 'waiting.html';
    });
  </script>
</body>
</html>
