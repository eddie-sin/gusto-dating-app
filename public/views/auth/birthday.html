<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Birthday Input</title>
    <script src="https://cdn.tailwindcss.com"></script>
   
    <link href="https://fonts.googleapis.com/css2?family=Rufina:wght@400;600&display=swap" rel="stylesheet">
    <!-- Font Awesome (working CDN) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

    <style>
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .animate-float {
        animation: float 4s ease-in-out infinite;
        will-change: transform;
      }

      .fade-in {
        animation: fadeIn 1.5s ease-out both;
      }

      .card { backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); min-height: 350px; }

      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }

      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      .dropdown-list { box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); border: 1px solid rgba(236, 72, 153, 0.3); }
      .font-serif { font-family: 'Rufina', serif; }

      /* Standard next/skip button style */
      .next-btn { width: 96px; padding: 6px; font-family: 'Rufina', serif; font-size: 14px; color: black; background: linear-gradient(135deg, #F78998 0%, #fa97a9 50%, #F78998 100%); position: relative; overflow: hidden; border-width: 0.11rem; border-style: solid; border-top-color: #ffffffcc; border-bottom-color: #ffffffcc; border-left-color: #fa97a9; border-right-color: #fa97a9; border-radius: 55px; box-shadow: 0px 36.86px 13.98px rgba(255, 106, 106, 0.02), 0px 20.34px 12.71px rgba(255, 106, 106, 0.08), 0px 8.9px 8.9px rgba(255, 106, 106, 0.13), 0px 2.54px 5.08px rgba(255, 106, 106, 0.15); cursor: pointer; transition: 0.25s ease; }
      .next-btn::before { content: ""; position: absolute; top: 0; left: 0; height: 100%; width: 100%; background: linear-gradient(90deg, rgba(255,255,255,0.35) 0%, rgba(255,255,255,0) 40%, rgba(255,255,255,0) 60%, rgba(255,255,255,0.35) 100%); pointer-events: none; border-radius: 55px; }
      .next-btn:hover { transform: translateY(-2px) scale(1.02); }

      /* Spinner for Next/Skip buttons */
      .loading { display:inline-block; width:16px; height:16px; border:3px solid rgba(255,255,255,0.3); border-radius:50%; border-top-color:white; animation:spin 1s linear infinite; margin-left:8px; }
      .hidden { display:none !important; }
      @keyframes spin { to { transform: rotate(360deg); } }

      /* Back button style */
      .mbti-btn { position: relative; background: radial-gradient(circle at 30% 100%, rgba(255,255,255,0.55) 0%, rgba(255,255,255,0.25) 35%, rgba(255,182,193,0.18) 60%, rgba(255,160,180,0.1) 80%, rgba(255,150,170,0.05) 100%), rgba(255,192,203,0.25); border-radius: 1.2rem; color:#111; font-weight:500; transition: all 0.25s ease-in-out; overflow:hidden; z-index:1; box-shadow: inset 0 0 1px rgba(255,255,255,0.6), inset 0 -1px 3px rgba(255,255,255,0.4); }
      .mbti-btn::before { content:""; position:absolute; inset:0; border-radius:inherit; padding:1.4px; background:linear-gradient(150deg, rgba(255,255,255,0.9), rgba(255,190,210,0.65)); -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0); mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0); -webkit-mask-composite:xor; mask-composite:exclude; z-index:-1; }
      .mbti-btn:hover { transform: scale(1.06); box-shadow: 0 0 18px rgba(255,180,200,0.85); }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        20%,
        60% {
          transform: translateX(-10px);
        }
        40%,
        80% {
          transform: translateX(10px);
        }
      }

      .shake {
        animation: shake 0.5s ease;
      }

      .error {
        border-color: #f43f5e !important;
        box-shadow: 0 0 10px rgba(244, 63, 94, 0.6);
      }

      /* Text color for DD, MM, YYYY buttons */
      .dropdown-btn span:first-child {
        color: #ff4d6d;
        font-weight: 500;
      }

      /* Dropdown list text color */
      .dropdown-list li {
        color: #ff4d6d;
      }

      /* When user hovers over an option */
      .dropdown-list li:hover {
        background-color: #ffe4ea; /* soft pink hover background */
        color: #ff4d6d;
      }



        /* ====== MODAL FIX ====== */
#uploadGuidanceModal {
  display: none;
  position: fixed;
  inset: 0;
  justify-content: center;
  align-items: flex-start; /* top pop-up */
  z-index: 9999;
  /* pointer-events: none; */
}

/* NEW: visible state */
#uploadGuidanceModal.open {
  display: flex;
  pointer-events: auto;
  animation: slideDown 260ms ease-out;
}

@keyframes slideDown {
  from { transform: translateY(-10px); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}

/* UPDATED modal content to be a top bar with responsive width */
.modal-content {
  width: min(720px, calc(100% - 32px));
  max-height: 35vh; /* <-- limit height to 80% of viewport */
  margin-top: 28px;
  border-radius: 12px;
  overflow: hidden;
  backdrop-filter: blur(10px);
  background: rgba(255,255,255,0.85);
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
}

/* Body scroll */
.modal-body {
  padding: 16px;
  overflow-y: auto;  /* <-- scroll vertically if content is too tall */
  flex: 1 1 auto;    /* take remaining space in modal */
}

/* NEW: header bar (red/pink) */
.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: linear-gradient(90deg,#F78998,#fa97a9 60%);
  color: white;
}

/* NEW: header title */
.modal-header h2 {
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
}

/* NEW: close button using Font Awesome */
.modal-close-button {
  background: transparent;
  border: none;
  color: white;
  font-size: 18px;
  cursor: pointer;
  padding: 6px;
  border-radius: 6px;
}
.modal-close-button:focus { outline: 2px solid rgba(255,255,255,0.3); }

/* small-screen tweak */
@media (max-width:420px) {
  .modal-content { width: calc(100% - 16px); margin-top: 16px; }
  .modal-header h2 { font-size: 0.95rem; }
}


.info-icon {
  font-size: 20px;
  color: black;
  cursor: pointer;
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 10;
}

.custom-leading {
  line-height: 1.8; /* adjust this value as needed */
}

    </style>
  </head>

  <body
    class="flex items-center justify-center min-h-screen px-4 relative"
    style="
      background-image: url('../../img/bgimg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    "
  >
    <!-- Back Button -->
    <div class="absolute top-6 left-6 z-50">
      <button onclick="window.location.href='enter-name.html'" class="mbti-btn inline-flex items-center rounded-full font-medium w-[95px] sm:w-[105px] md:w-[115px] h-[40px] sm:h-[43px] md:h-[45px] px-4 sm:px-6 text-base sm:text-lg transition-all duration-200">
        <span class="mr-2 text-lg sm:text-xl leading-none">&lt;</span>
        <span class="font-serif leading-none">Back</span>
      </button>
    </div>

    <div
      class="card animate-float fade-in bg-white/15 rounded-3xl p-8 sm:p-10 md:p-12 lg:p-14 text-center shadow-2xl w-full max-w-[420px] sm:max-w-[480px] md:max-w-[520px] lg:max-w-[600px] xl:max-w-[640px] border border-white/30"
    >
    <span class="info-icon" onclick="openGuidanceModal()" role="button" aria-label="Upload guidance" title="Upload guidance">
  <i class="fa-solid fa-circle-exclamation" style="font-size:20px; color:black;"></i>
</span>

<!-- modal inner structure with a top-bar header + body -->
<div id="uploadGuidanceModal" aria-hidden="true" role="dialog" aria-labelledby="uploadGuidanceTitle">
  <div class="modal-content" role="document">
    <div class="modal-header">
      <h2 id="uploadGuidanceTitle" class="text-base sm:text-lg md:text-xl lg:text-2xl custom-leading">User guidance</h2>
      <!-- Font Awesome X icon (accessible button) -->
      <button class="modal-close-button" onclick="closeGuidanceModal()" aria-label="Close upload guidance">
        <i class="fa-solid fa-xmark" aria-hidden="true"></i>
      </button>
    </div>

    <div class="modal-body" style="padding:16px; text-align:left;">
      <div class="modal-body p-4 text-left font-inter font-normal">
        <p class="mb-4 text-sm sm:text-base md:text-lg lg:text-xl font-medium custom-leading">How to fill the data correctly:</p>
  
        <ul class="list-disc list-inside text-xs sm:text-sm md:text-base lg:text-lg mb-4 custom-leading">
      <li>Fill in your date of birth exactly as listed on your official documents, such as your NRC or GUSTO College Student ID. <br>For example, if your birthday is <strong>10 December 2000</strong>, enter it in the format <strong>10/12/2000</strong>.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
      <h2
        class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-semibold text-black mb-8 drop-shadow-sm"
      >
        When's your birthday?
      </h2>

      <div class="flex flex-col items-center mt-10">
        <div class="flex flex-wrap justify-center gap-4 sm:gap-6 mb-10">
          <!-- Day -->
          <div class="relative flex flex-col items-center w-20 sm:w-24 md:w-36">
            <label class="text-black font-medium mb-1 text-sm sm:text-base">Day</label>
            <button
              id="dayBtn"
              class="dropdown-btn w-full px-4 py-3 text-base sm:text-lg rounded-full border border-black bg-transparent text-gray-700 hover:bg-transparent focus:ring-2 focus:ring-pink-400 transition-all duration-200 flex justify-between items-center backdrop-blur-sm"
            >
              <span>DD</span>
              <span style="color: #FF4D6D;">▼</span>
            </button>

            <ul
              id="dayList"
              class="dropdown-list absolute left-0 top-full mt-1 hidden bg-white rounded-xl max-h-48 overflow-y-auto no-scrollbar text-gray-700 text-base w-full z-50"
            ></ul>
          </div>

          <!-- Month -->
          <div class="relative flex flex-col items-center w-28 sm:w-32 md:w-36">
            <label class="text-black font-medium mb-1 text-sm sm:text-base">Month</label>
            <button
              id="monthBtn"
              class="dropdown-btn w-full px-4 py-3 text-base sm:text-lg rounded-full border border-black bg-transparent text-gray-700 hover:bg-transparent focus:ring-2 focus:ring-pink-400 transition-all duration-200 flex justify-between items-center backdrop-blur-sm"
            >
              <span>MM</span>
              <span style="color: #FF4D6D;">▼</span>
            </button>

            <ul
              id="monthList"
              class="dropdown-list absolute left-0 top-full mt-1 hidden bg-white rounded-xl max-h-48 overflow-y-auto no-scrollbar text-gray-700 text-base w-full z-50"
            ></ul>
          </div>

          <!-- Year -->
          <div class="relative flex flex-col items-center w-24 sm:w-28 md:w-32">
            <label class="text-black font-medium mb-1 text-sm sm:text-base">Year</label>
            <button
              id="yearBtn"
              class="dropdown-btn w-full px-4 py-3 text-base sm:text-lg rounded-full border border-black bg-transparent text-gray-700 hover:bg-transparent focus:ring-2 focus:ring-pink-400 transition-all duration-200 flex justify-between items-center backdrop-blur-sm"
            >
              <span>YYYY</span>
              <span style="color: #FF4D6D;">▼</span>
            </button>

            <ul
              id="yearList"
              class="dropdown-list absolute left-0 top-full mt-1 hidden bg-white rounded-xl max-h-48 overflow-y-auto no-scrollbar text-gray-700 text-base w-full z-50"
            ></ul>
          </div>
        </div>

        <div class="flex justify-end mt-6">
          <button id="nextBtn" class="next-btn"><span class="btn-text">Next</span><span class="loading hidden"></span></button>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const createList = (id, values, type) => {
          const list = document.getElementById(id);
          values.forEach((val) => {
            const li = document.createElement("li");
            li.textContent = val;
            li.className =
              "px-4 py-3 hover:bg-pink-50 cursor-pointer border-b border-gray-100 last:border-b-0";
            li.onclick = () => selectValue(type, val);
            list.appendChild(li);
          });
        };

        // Day list
        createList(
          "dayList",
          Array.from({ length: 31 }, (_, i) => String(i + 1).padStart(2, "0")),
          "day"
        );

        // Month list
        createList(
          "monthList",
          [
            "January","February","March","April","May","June",
            "July","August","September","October","November","December",
          ],
          "month"
        );

        // Year list
        const currentYear = new Date().getFullYear();
        createList(
          "yearList",
          Array.from({ length: currentYear - 1899 }, (_, i) => currentYear - i),
          "year"
        );

        // Dropdown toggle logic
        const dropdowns = [
          { btn: "dayBtn", list: "dayList" },
          { btn: "monthBtn", list: "monthList" },
          { btn: "yearBtn", list: "yearList" },
        ];

        dropdowns.forEach(({ btn, list }) => {
          const button = document.getElementById(btn);
          const dropdown = document.getElementById(list);

          button.dataset.selected = "false";
          button.addEventListener("click", (e) => {
            e.stopPropagation();
            document.querySelectorAll(".dropdown-list").forEach((dd) => {
              if (dd !== dropdown) dd.classList.add("hidden");
            });
            dropdown.classList.toggle("hidden");
          });
        });

        document.addEventListener("click", (e) => {
          document
            .querySelectorAll(".dropdown-list")
            .forEach((dd) => dd.classList.add("hidden"));
        });
      });

      function selectValue(type, value) {
        const button = document.getElementById(`${type}Btn`);
        const spans = button.querySelectorAll("span");
        spans[0].textContent = value; // update only the text span
        button.classList.add("bg-white", "text-pink-700", "font-medium");
        button.dataset.selected = "true";
      }

      function triggerAlarm(button) {
        button.classList.add("shake");
        setTimeout(() => button.classList.remove("shake"), 500);
      }

      document.getElementById("nextBtn").addEventListener("click", (e) => {
        e.preventDefault();
        document.dispatchEvent(new Event('registration:submit'));
      });

      // Registration hooks
      window.prefillPage = function(prefill) {
        const iso = prefill.dob ?? localStorage.getItem('dob');
        if (!iso) return;
        const d = new Date(iso);
        const day = String(d.getDate()).padStart(2,'0');
        const monthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];
        const month = monthNames[d.getMonth()];
        const year = String(d.getFullYear());
        selectValue('day', day);
        selectValue('month', month);
        selectValue('year', year);
      };

      window.collectPageData = function() {
        const dayBtn = document.getElementById("dayBtn");
        const monthBtn = document.getElementById("monthBtn");
        const yearBtn = document.getElementById("yearBtn");

        let allSelected = true;

        [dayBtn, monthBtn, yearBtn].forEach((btn) => {
          if (btn.dataset.selected !== "true") {
            btn.classList.add("error");
            triggerAlarm(btn);
            allSelected = false;
          } else {
            btn.classList.remove("error");
          }
        });

        if (!allSelected) {
          alert("⚠️ Please select your full birthday before continuing!");
          return null;
        }

        const day = dayBtn.querySelector("span:first-child").textContent;
        const month = monthBtn.querySelector("span:first-child").textContent;
        const year = yearBtn.querySelector("span:first-child").textContent;
        const monthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];
        const monthNum = monthNames.indexOf(month) + 1;
        const dob = new Date(year, monthNum - 1, parseInt(day));
        const today = new Date();
        const age = today.getFullYear() - parseInt(year) - (today.getMonth() < monthNum - 1 || (today.getMonth() === monthNum - 1 && today.getDate() < parseInt(day)) ? 1 : 0);
        if (age < 18) {
          alert("⚠️ You must be at least 18 years old to register.");
          return null;
        }
        if (dob > today) {
          alert("⚠️ Date of birth cannot be in the future.");
          return null;
        }
        const iso = dob.toISOString();
        localStorage.setItem('dob', iso);
        return { dob: iso };
      };

        function openGuidanceModal() {
  document.getElementById('uploadGuidanceModal').style.display = 'flex';
}
function closeGuidanceModal() {
  document.getElementById('uploadGuidanceModal').style.display = 'none';
}

    </script>

  <script type="module" src="/js/registration.js"></script>
  </body>
</html>
