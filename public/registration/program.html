<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Select Program & Batch</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Rufina:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <script type="module" src="/js/registration.js"></script>
    <style>
      body {
        font-family: "Rufina", serif;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }
      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        20%,
        60% {
          transform: translateX(-10px);
        }
        40%,
        80% {
          transform: translateX(10px);
        }
      }
      .animate-float {
        animation: float 4s ease-in-out infinite;
        will-change: transform;
      }
      .shake {
        animation: shake 0.5s ease;
      }
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      /* Next button style */
      .next-btn {
        width: 96px;
        padding: 6px;
        font-family: "Rufina", serif;
        font-size: 14px;
        color: black;
        background: linear-gradient(
          135deg,
          #f78998 0%,
          #fa97a9 50%,
          #f78998 100%
        );
        position: relative;
        overflow: hidden;
        border-width: 0.11rem;
        border-style: solid;
        border-top-color: #ffffffcc;
        border-bottom-color: #ffffffcc;
        border-left-color: #fa97a9;
        border-right-color: #fa97a9;
        border-radius: 55px;
        box-shadow: 0px 36.86px 13.98px rgba(255, 106, 106, 0.02),
          0px 20.34px 12.71px rgba(255, 106, 106, 0.08),
          0px 8.9px 8.9px rgba(255, 106, 106, 0.13),
          0px 2.54px 5.08px rgba(255, 106, 106, 0.15);
        cursor: pointer;
        transition: 0.25s ease;
      }
      .next-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.35) 0%,
          rgba(255, 255, 255, 0) 40%,
          rgba(255, 255, 255, 0) 60%,
          rgba(255, 255, 255, 0.35) 100%
        );
        pointer-events: none;
        border-radius: 55px;
      }
      .next-btn:hover {
        transform: translateY(-2px) scale(1.02);
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.35),
          rgba(255, 255, 255, 0)
        );
      }

      /* Dropdown hover */
      #programList li:hover {
        background-color: #f7788f !important;
        color: black !important;
        border-radius: 9999px;
        margin: 2px 6px;
        transition: all 0.2s ease;
      }

      .mbti-btnB {
        position: relative;
        background: radial-gradient(
            circle at 30% 100%,
            rgba(255, 255, 255, 0.55) 0%,
            rgba(255, 255, 255, 0.25) 35%,
            rgba(255, 182, 193, 0.18) 60%,
            rgba(255, 160, 180, 0.1) 80%,
            rgba(255, 150, 170, 0.05) 100%
          ),
          rgba(255, 192, 203, 0.25);
        border-radius: 1.2rem;
        color: #111;
        font-weight: 500;
        transition: all 0.25s ease-in-out;
        overflow: hidden;
        z-index: 1;
        box-shadow: inset 0 0 1px rgba(255, 255, 255, 0.6),
          inset 0 -1px 3px rgba(255, 255, 255, 0.4);
      }
      .mbti-btnB::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: inherit;
        padding: 1.4px;
        background: linear-gradient(
          150deg,
          rgba(255, 255, 255, 0.9),
          rgba(255, 190, 210, 0.65)
        );
        -webkit-mask: linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        z-index: -1;
      }
      .mbti-btnB:hover {
        transform: scale(1.06);
        box-shadow: 0 0 18px rgba(255, 180, 200, 0.85);
      }

      .selected {
        background: radial-gradient(
            circle at 30% 100%,
            rgba(255, 255, 255, 0.55) 0%,
            rgba(255, 160, 180, 0.4) 50%,
            rgba(255, 100, 130, 0.25) 80%
          ),
          linear-gradient(to bottom right, #ff8eb5, #ff4f85);
        color: black;
        box-shadow: 0 0 22px rgba(255, 110, 150, 0.8);
        transform: scale(1.08);
      }
    </style>
  </head>

  <body
    class="flex items-center justify-center min-h-screen px-4 relative"
    style="
      background-image: url('bgimg.jpg');
      background-size: cover;
      background-position: center;
    "
  >
    <div class="relative w-full max-w-[600px] mx-auto mt-20">
      <button
        id="backBtn"
        class="mbti-btnB absolute -top-20 left-2 flex items-center justify-start font-medium w-[110px] h-[45px] px-4 text-lg z-20"
      >
        <i class="fa-solid fa-arrow-left mr-2"></i>
        <span class="font-serif leading-none">Back</span>
      </button>

      <div
        id="card"
        class="bg-white/15 backdrop-blur-lg rounded-3xl p-6 sm:p-8 shadow-2xl border border-white/30 animate-float"
      >
        <div class="flex flex-col space-y-6">
          <!-- Program selection -->
          <div class="flex flex-col sm:flex-row justify-between">
            <label
              class="text-black font-semibold text-sm sm:text-base sm:w-1/2 mb-4"
              >Select Your Program</label
            >
            <div class="relative w-full sm:w-1/2">
              <button
                id="programBtn"
                class="w-full px-4 py-2 rounded-full border border-pink-300 bg-transparent text-black flex justify-between items-center mb-4"
              >
                <span>Programs</span>
                <span>▼</span>
              </button>
              <ul
                id="programList"
                class="absolute left-0 top-full mt-2 hidden bg-[#EEE6E6] rounded-xl max-h-56 overflow-y-auto no-scrollbar text-gray-700 w-full z-50 shadow-lg"
              >
                <li class="px-3 py-2 cursor-pointer">Pre IGCSE</li>
                <li class="px-3 py-2 cursor-pointer">IGCSE</li>
                <li class="px-3 py-2 cursor-pointer">PRE GED</li>
                <li class="px-3 py-2 cursor-pointer">GED</li>
                <li class="px-3 py-2 cursor-pointer">Level 3 Foundation</li>
                <li class="px-3 py-2 cursor-pointer">GUF Foundation</li>
                <li class="px-3 py-2 cursor-pointer">HND Computing</li>
                <li class="px-3 py-2 cursor-pointer">HND Business</li>
              </ul>
            </div>
          </div>

          <!-- Batch input -->
          <div class="flex flex-col sm:flex-row justify-between">
            <label
              class="text-black font-semibold text-sm sm:text-base sm:w-1/2 mb-4"
              >Enter Your Batch Number</label
            >
            <input
              id="batchInput"
              type="text"
              placeholder="Eg: level3C32, HND01"
              class="w-full sm:w-1/2 px-4 py-2 rounded-full border border-pink-300 bg-transparent text-black placeholder-black text-base focus:ring-2 focus:ring-pink-400"
            />
          </div>

          <!-- Next button -->
          <div class="flex justify-end">
            <button id="nextBtn" class="next-btn">Next</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      const programBtn = document.getElementById("programBtn");
      const programList = document.getElementById("programList");
      const batchInput = document.getElementById("batchInput");
      const nextBtn = document.getElementById("nextBtn");

      let selectedProgram = "";

      // PREFILL HOOK
      window.prefillPage = function (data) {
        if (!data) return;
        if (data.program) {
          selectedProgram = data.program;
          programBtn.querySelector("span:first-child").textContent =
            data.program;
        }
        if (data.batch) batchInput.value = data.batch;
      };

      // COLLECT PAGE DATA
      window.collectPageData = function () {
        const program =
          programBtn.querySelector("span:first-child").textContent;
        const batch = batchInput.value.trim();
        if (!program || program === "Programs" || !batch) return null;
        if (batch.length > 50) return null;
        return { program, batch };
      };

      // Program dropdown logic
      programBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        programList.classList.toggle("hidden");
        programBtn.querySelector("span:last-child").textContent =
          programList.classList.contains("hidden") ? "▼" : "▲";
      });

      document.addEventListener("click", () => {
        programList.classList.add("hidden");
        programBtn.querySelector("span:last-child").textContent = "▼";
      });

      document.querySelectorAll("#programList li").forEach((li) => {
        li.addEventListener("click", () => {
          programBtn.querySelector("span:first-child").textContent =
            li.textContent;
          selectedProgram = li.textContent;
          programList.classList.add("hidden");
          programBtn.querySelector("span:last-child").textContent = "▼";
        });
      });

      // Trigger save via registration.js
      nextBtn.addEventListener("click", () => {
        document.dispatchEvent(new CustomEvent("registration:submit"));
      });

      // Back button handled by registration.js
    </script>
  </body>
</html>
